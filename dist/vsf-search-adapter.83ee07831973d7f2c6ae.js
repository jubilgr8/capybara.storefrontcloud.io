(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1124:function(e,n,r){"use strict";function t(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,n){if(!e)return;if("string"==typeof e)return i(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,n)}(e))){var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var t,a,o=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw a}}}}function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function a(e){var n,r,t,i={},a=e.attribute.split(".");if(a.length>1){for(var o=e.value,s=a.length-1;s>=0;s--)n={},r=a[s],t=o,r in n?Object.defineProperty(n,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[r]=t,o=n;i=o}else i[e.attribute]=e.value;return i}function o(e){var n={},r=void 0!==e.searchQuery.getAppliedFilters?e.searchQuery.getAppliedFilters():{};n.search=e.searchQuery.getSearchText(),n.sort={},n.filter={},n._sourceInclude={},n._sourceExclude={};var i=e.searchQuery.getAvailableFilters();if(i.length>0){var o,s=t(i);try{for(s.s();!(o=s.n()).done;){var u=o.value;n.filter[u.field]={},void 0!==u.scope&&(n.filter[u.field].scope=u.scope)}}catch(e){s.e(e)}finally{s.f()}}var c,l=t(r);try{for(l.s();!(c=l.n()).done;){var d=c.value;d.scope&&(d.value.scope=d.scope,delete d.scope);var f=a(d);n.filter=Object.assign(n.filter,f)}}catch(e){l.e(e)}finally{l.f()}if(""!==e.sort){var m=e.sort.split(":");void 0!==m[1]?n.sort[m[0]]=m[1].toUpperCase():"_score"===m[0]?n.sort[m[0]]="DESC":n.sort[m[0]]="ASC"}return n.pageSize=e.size,n.currentPage=e.from/e.size+1,n.attributes=n.filter,n._sourceInclude=e._sourceInclude,n._sourceExclude=e._sourceExclude,n}function s(e){var n="",t=o(e);switch(e.type){case"product":n=r(1125);break;case"attribute":n=r(1126);break;case"category":n=r(1127);break;case"taxrule":n=r(1128);break;case"cms_page":n=r(1129);break;case"cms_block":n=r(1130);break;case"cms_hierarhy":n=r(1131)}return JSON.stringify({query:n,variables:t})}r.r(n),r.d(n,"prepareQueryVars",(function(){return o})),r.d(n,"prepareGraphQlBody",(function(){return s}))},1125:function(e,n){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ProductListFilters"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"ProductFilterInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"search"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"currentPage"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sort"}},type:{kind:"NamedType",name:{kind:"Name",value:"ProductSortInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"_sourceInclude"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"_sourceExclude"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"products"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}},{kind:"Argument",name:{kind:"Name",value:"search"},value:{kind:"Variable",name:{kind:"Name",value:"search"}}},{kind:"Argument",name:{kind:"Name",value:"pageSize"},value:{kind:"Variable",name:{kind:"Name",value:"pageSize"}}},{kind:"Argument",name:{kind:"Name",value:"currentPage"},value:{kind:"Variable",name:{kind:"Name",value:"currentPage"}}},{kind:"Argument",name:{kind:"Name",value:"sort"},value:{kind:"Variable",name:{kind:"Name",value:"sort"}}},{kind:"Argument",name:{kind:"Name",value:"_sourceInclude"},value:{kind:"Variable",name:{kind:"Name",value:"_sourceInclude"}}},{kind:"Argument",name:{kind:"Name",value:"_sourceExclude"},value:{kind:"Variable",name:{kind:"Name",value:"_sourceExclude"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"total_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"aggregations"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_fields"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"page_info"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"page_size"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"current_page"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:634}};r.loc.source={body:"query ProductListFilters (\n    $filter: ProductFilterInput,\n    $search: String!,\n    $pageSize: Int,\n    $currentPage: Int,\n    $sort: ProductSortInput,\n    $_sourceInclude: [String],\n    $_sourceExclude: [String]\n  ) {\n    products(\n      filter: $filter\n      search: $search\n      pageSize: $pageSize\n      currentPage: $currentPage\n      sort: $sort\n      _sourceInclude: $_sourceInclude\n      _sourceExclude: $_sourceExclude\n    )\n    {\n      items\n      total_count\n      aggregations\n      sort_fields{\n        options {\n          value\n        }\n      }\n      page_info{\n        page_size\n        current_page\n      }\n    }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var r=0;r<e.definitions.length;r++){var t=e.definitions[r];if(t.name&&t.name.value==n)return t}}r.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,r){if("FragmentSpread"===n.kind)r.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&r.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,r)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,r)})),n.definitions&&n.definitions.forEach((function(n){e(n,r)}))}(e,n),t[e.name.value]=n}})),e.exports=r,e.exports.ProductListFilters=function(e,n){var r={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=t[n]||new Set,o=new Set,s=new Set;for(a.forEach((function(e){s.add(e)}));s.size>0;){var u=s;s=new Set,u.forEach((function(e){o.has(e)||(o.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=i(e,n);t&&r.definitions.push(t)})),r}(r,"ProductListFilters")},1126:function(e,n){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"customAttributeMetadata"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attributes"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AttributeInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"_sourceInclude"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAttributeMetadata"},arguments:[{kind:"Argument",name:{kind:"Name",value:"attributes"},value:{kind:"Variable",name:{kind:"Name",value:"attributes"}}},{kind:"Argument",name:{kind:"Name",value:"_sourceInclude"},value:{kind:"Variable",name:{kind:"Name",value:"_sourceInclude"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hits"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:203}};r.loc.source={body:"query customAttributeMetadata ($attributes: AttributeInput!, $_sourceInclude: [String]) {\n  customAttributeMetadata(\n    attributes: $attributes\n    _sourceInclude: $_sourceInclude\n  )\n  {\n    hits\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var r=0;r<e.definitions.length;r++){var t=e.definitions[r];if(t.name&&t.name.value==n)return t}}r.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,r){if("FragmentSpread"===n.kind)r.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&r.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,r)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,r)})),n.definitions&&n.definitions.forEach((function(n){e(n,r)}))}(e,n),t[e.name.value]=n}})),e.exports=r,e.exports.customAttributeMetadata=function(e,n){var r={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=t[n]||new Set,o=new Set,s=new Set;for(a.forEach((function(e){s.add(e)}));s.size>0;){var u=s;s=new Set,u.forEach((function(e){o.has(e)||(o.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=i(e,n);t&&r.definitions.push(t)})),r}(r,"customAttributeMetadata")},1127:function(e,n){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CategoryList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"CategoryFilterInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"currentPage"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sort"}},type:{kind:"NamedType",name:{kind:"Name",value:"CategorySortInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"_sourceInclude"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"categories"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}},{kind:"Argument",name:{kind:"Name",value:"pageSize"},value:{kind:"Variable",name:{kind:"Name",value:"pageSize"}}},{kind:"Argument",name:{kind:"Name",value:"currentPage"},value:{kind:"Variable",name:{kind:"Name",value:"currentPage"}}},{kind:"Argument",name:{kind:"Name",value:"sort"},value:{kind:"Variable",name:{kind:"Name",value:"sort"}}},{kind:"Argument",name:{kind:"Name",value:"_sourceInclude"},value:{kind:"Variable",name:{kind:"Name",value:"_sourceInclude"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hits"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"suggest"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:338}};r.loc.source={body:"query CategoryList (\n    $filter: CategoryFilterInput,\n    $pageSize: Int,\n    $currentPage: Int,\n    $sort: CategorySortInput,\n    $_sourceInclude: [String]\n  ) {\n  categories(\n    filter: $filter\n    pageSize: $pageSize\n    currentPage: $currentPage\n    sort: $sort\n    _sourceInclude: $_sourceInclude\n  )\n  {\n    hits\n    suggest\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var r=0;r<e.definitions.length;r++){var t=e.definitions[r];if(t.name&&t.name.value==n)return t}}r.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,r){if("FragmentSpread"===n.kind)r.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&r.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,r)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,r)})),n.definitions&&n.definitions.forEach((function(n){e(n,r)}))}(e,n),t[e.name.value]=n}})),e.exports=r,e.exports.CategoryList=function(e,n){var r={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=t[n]||new Set,o=new Set,s=new Set;for(a.forEach((function(e){s.add(e)}));s.size>0;){var u=s;s=new Set,u.forEach((function(e){o.has(e)||(o.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=i(e,n);t&&r.definitions.push(t)})),r}(r,"CategoryList")},1128:function(e,n){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"taxrule"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"TaxRuleInput"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"taxrule"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hits"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:93}};r.loc.source={body:"query taxrule ($filter: TaxRuleInput) {\n  taxrule(\n    filter: $filter\n  )\n  {\n    hits\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var r=0;r<e.definitions.length;r++){var t=e.definitions[r];if(t.name&&t.name.value==n)return t}}r.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,r){if("FragmentSpread"===n.kind)r.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&r.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,r)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,r)})),n.definitions&&n.definitions.forEach((function(n){e(n,r)}))}(e,n),t[e.name.value]=n}})),e.exports=r,e.exports.taxrule=function(e,n){var r={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=t[n]||new Set,o=new Set,s=new Set;for(a.forEach((function(e){s.add(e)}));s.size>0;){var u=s;s=new Set,u.forEach((function(e){o.has(e)||(o.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=i(e,n);t&&r.definitions.push(t)})),r}(r,"taxrule")},1129:function(e,n){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"cmsPages"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"CmsInput"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cmsPages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"identifier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meta_description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meta_keywords"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:186}};r.loc.source={body:"query cmsPages ($filter: CmsInput) {\n  cmsPages(\n    filter: $filter\n  )\n  {\n    items {\n      title\n      identifier\n      content\n      meta_description\n      meta_keywords\n    }\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var r=0;r<e.definitions.length;r++){var t=e.definitions[r];if(t.name&&t.name.value==n)return t}}r.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,r){if("FragmentSpread"===n.kind)r.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&r.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,r)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,r)})),n.definitions&&n.definitions.forEach((function(n){e(n,r)}))}(e,n),t[e.name.value]=n}})),e.exports=r,e.exports.cmsPages=function(e,n){var r={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=t[n]||new Set,o=new Set,s=new Set;for(a.forEach((function(e){s.add(e)}));s.size>0;){var u=s;s=new Set,u.forEach((function(e){o.has(e)||(o.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=i(e,n);t&&r.definitions.push(t)})),r}(r,"cmsPages")},1130:function(e,n){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"cmsBlocks"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"CmsInput"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cmsBlocks"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"identifier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"creation_time"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:175}};r.loc.source={body:"query cmsBlocks ($filter: CmsInput) {\n  cmsBlocks(\n    filter: $filter\n  )\n  {\n    items {\n      title\n      id\n      identifier\n      content\n      creation_time\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var r=0;r<e.definitions.length;r++){var t=e.definitions[r];if(t.name&&t.name.value==n)return t}}r.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,r){if("FragmentSpread"===n.kind)r.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&r.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,r)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,r)})),n.definitions&&n.definitions.forEach((function(n){e(n,r)}))}(e,n),t[e.name.value]=n}})),e.exports=r,e.exports.cmsBlocks=function(e,n){var r={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=t[n]||new Set,o=new Set,s=new Set;for(a.forEach((function(e){s.add(e)}));s.size>0;){var u=s;s=new Set,u.forEach((function(e){o.has(e)||(o.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=i(e,n);t&&r.definitions.push(t)})),r}(r,"cmsBlocks")},1131:function(e,n){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"cmsHierarchies"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"CmsInput"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cmsHierarchies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"page_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"xpath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"request_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_node_id"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:189}};r.loc.source={body:"query cmsHierarchies ($filter: CmsInput) {\n  cmsHierarchies(\n    filter: $filter\n  )\n  {\n    items {\n      page_id\n      label\n      xpath\n      request_url\n      parent_node_id\n    }\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var r=0;r<e.definitions.length;r++){var t=e.definitions[r];if(t.name&&t.name.value==n)return t}}r.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,r){if("FragmentSpread"===n.kind)r.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&r.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,r)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,r)})),n.definitions&&n.definitions.forEach((function(n){e(n,r)}))}(e,n),t[e.name.value]=n}})),e.exports=r,e.exports.cmsHierarchies=function(e,n){var r={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=t[n]||new Set,o=new Set,s=new Set;for(a.forEach((function(e){s.add(e)}));s.size>0;){var u=s;s=new Set,u.forEach((function(e){o.has(e)||(o.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=i(e,n);t&&r.definitions.push(t)})),r}(r,"cmsHierarchies")},1132:function(e,n,r){"use strict";r.r(n),r.d(n,"processESResponseType",(function(){return o})),r.d(n,"processProductsType",(function(){return s})),r.d(n,"processCmsType",(function(){return u}));var t=r(1139),i=r(3),a=r(0);function o(e,n,r){return{items:Object(t.a)(e.hits.hits,(function(e){return Object.assign(e._source,{_score:e._score,slug:e._source.slug?e._source.slug:e._source.hasOwnProperty("url_key")&&a.products.useMagentoUrlKeys?e._source.url_key:e._source.hasOwnProperty("name")?Object(i.m)(e._source.name)+"-"+e._source.id:""})})),total:e.hits.total,start:n,perPage:r,aggregations:e.aggregations,suggestions:e.suggest}}function s(e,n,r){return{items:Object(t.a)(e.items,(function(e){var n={};return e._score&&(n._score=e._score,delete e._score),n.slug=e.slug?e.slug:e.url_key&&a.products.useMagentoUrlKeys?e.url_key:e.name?Object(i.m)(e.name)+"-"+e.id:"",Object.assign(e,n)})),total:e.total_count,start:n,perPage:r,aggregations:e.aggregations,suggestions:e.suggest}}function u(e,n,r){return{items:e.items,total:e.total_count,start:n,perPage:r,aggregations:e.aggregations,suggestions:e.suggest}}},1183:function(e,n){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ReviewList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"ReviewFilterInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"currentPage"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"reviews"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}},{kind:"Argument",name:{kind:"Name",value:"pageSize"},value:{kind:"Variable",name:{kind:"Name",value:"pageSize"}}},{kind:"Argument",name:{kind:"Name",value:"currentPage"},value:{kind:"Variable",name:{kind:"Name",value:"currentPage"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hits"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"suggest"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:218}};r.loc.source={body:"query ReviewList (\n    $filter: ReviewFilterInput,\n    $pageSize: Int,\n    $currentPage: Int\n  ) {\n  reviews(\n    filter: $filter\n    pageSize: $pageSize\n    currentPage: $currentPage\n  )\n  {\n    hits\n    suggest\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var r=0;r<e.definitions.length;r++){var t=e.definitions[r];if(t.name&&t.name.value==n)return t}}r.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,r){if("FragmentSpread"===n.kind)r.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&r.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,r)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,r)})),n.definitions&&n.definitions.forEach((function(n){e(n,r)}))}(e,n),t[e.name.value]=n}})),e.exports=r,e.exports.ReviewList=function(e,n){var r={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty("loc")&&(r.loc=e.loc);var a=t[n]||new Set,o=new Set,s=new Set;for(a.forEach((function(e){s.add(e)}));s.size>0;){var u=s;s=new Set,u.forEach((function(e){o.has(e)||(o.add(e),(t[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=i(e,n);t&&r.definitions.push(t)})),r}(r,"ReviewList")},1403:function(e,n,r){var t={"./gqlQuery":1124,"./gqlQuery.js":1124,"./processor/processType":1132,"./processor/processType.ts":1132,"./queries/categories":1127,"./queries/categories.gql":1127,"./queries/cmsBlock":1130,"./queries/cmsBlock.gql":1130,"./queries/cmsHierarchy":1131,"./queries/cmsHierarchy.gql":1131,"./queries/cmsPage":1129,"./queries/cmsPage.gql":1129,"./queries/customAttributeMetadata":1126,"./queries/customAttributeMetadata.gql":1126,"./queries/products":1125,"./queries/products.gql":1125,"./queries/reviews":1183,"./queries/reviews.gql":1183,"./queries/taxrule":1128,"./queries/taxrule.gql":1128,"./searchAdapter":954,"./searchAdapter.ts":954};function i(e){var n=a(e);return r(n)}function a(e){if(!r.o(t,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t[e]}i.keys=function(){return Object.keys(t)},i.resolve=a,e.exports=i,i.id=1403},954:function(e,n,r){"use strict";r.r(n),r.d(n,"SearchAdapter",(function(){return p}));var t=r(1124),i=r(8),a=r(195),o=r.n(a),s=r(1132),u=r(20),c=r(0),l=r(3),d=r(21),f=function(e,n,r,t){return new(r||(r=Promise))((function(i,a){function o(e){try{u(t.next(e))}catch(e){a(e)}}function s(e){try{u(t.throw(e))}catch(e){a(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}u((t=t.apply(e,n||[])).next())}))},m=function(e,n){var r,t,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,t&&(i=2&a[0]?t.return:a[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,a[1])).done)return i;switch(t=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,t=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e],t=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},p=function(){function e(){this.entities=[],this.initBaseTypes()}return e.prototype.search=function(e){return f(this,void 0,void 0,(function(){var n,r,a,s,f,p,v,h,y,k;return m(this,(function(m){switch(m.label){case 0:if(!(e.searchQuery instanceof u.SearchQuery))throw new Error("SearchQuery instance has wrong class required to process with graphQl request.");if(!this.entities[e.type])throw new Error("No entity type registered for "+e.type);return null!==e.store?[3,1]:(r=Object(i.b)(),[3,3]);case 1:return[4,Object(i.f)(e.store)];case 2:r=m.sent(),m.label=3;case 3:if(void 0===(n=r).storeCode||null==n.storeCode||!e.type)throw new Error("Store and SearchRequest.type are required arguments for executing Graphql query");return a=Object(t.prepareQueryVars)(e),s=this.entities[e.type].query,f=JSON.stringify({query:s,variables:a}),p="",Object(d.a)(this.entities[e.type],"url")?p=Object(d.a)(this.entities[e.type],"url"):(v=l.e?Object(d.a)(c.server,"protocol"):c.server.protocol,h=l.e?Object(d.a)(c.graphql,"host"):c.graphql.host,y=l.e?Object(d.a)(c.graphql,"port"):c.graphql.port,p=v+"://"+h+":"+y+"/graphql",k=""!==n.storeCode?encodeURIComponent(n.storeCode)+"/":"",p=p+"/"+k),[2,o()(p,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:f}).then((function(e){return e.json()})).catch((function(e){throw new Error("FetchError in request to ES: "+e.toString())}))]}}))}))},e.prototype.registerEntityType=function(e,n){var t=n.url,i=void 0===t?"":t,a=n.url_ssr,o=void 0===a?"":a,s=n.gql,u=n.queryProcessor,c=n.resultProcessor;return this.entities[e]={query:r(1403)(""+s),queryProcessor:u,resultProcessor:c},""!==i&&(this.entities[e].url=i),""!==o&&(this.entities[e].url_ssr=o),this},e.prototype.registerEntityTypeByQuery=function(e,n){var r=n.url,t=void 0===r?"":r,i=n.url_ssr,a=void 0===i?"":i,o=n.query,s=n.queryProcessor,u=n.resultProcessor;return this.entities[e]={query:o,queryProcessor:s,resultProcessor:u},""!==t&&(this.entities[e].url=t),""!==a&&(this.entities[e].url_ssr=a),this},e.prototype.initBaseTypes=function(){this.registerEntityType("product",{gql:"./queries/products.gql",queryProcessor:function(e){return e},resultProcessor:function(e,n,r){if(null===e)throw new Error("Invalid graphQl result - null not exepcted");if(e.hasOwnProperty("data"))return Object(s.processProductsType)(e.data.products,n,r);throw e.error?new Error(JSON.stringify(e.error)):new Error("Unknown error with graphQl result in resultProcessor for entity type 'product'")}}),this.registerEntityType("attribute",{gql:"./queries/customAttributeMetadata.gql",queryProcessor:function(e){return e},resultProcessor:function(e,n,r){if(null===e)throw new Error("Invalid graphQl result - null not exepcted");if(e.hasOwnProperty("data"))return Object(s.processESResponseType)(e.data.customAttributeMetadata,n,r);throw e.error?new Error(JSON.stringify(e.error)):new Error("Unknown error with graphQl result in resultProcessor for entity type 'attribute'")}}),this.registerEntityType("review",{gql:"./queries/reviews.gql",queryProcessor:function(e){return e},resultProcessor:function(e,n,r){if(null===e)throw new Error("Invalid graphQl result - null not exepcted");if(e.hasOwnProperty("data"))return Object(s.processESResponseType)(e.data.reviews,n,r);throw e.error?new Error(JSON.stringify(e.error)):new Error("Unknown error with graphQl result in resultProcessor for entity type 'review'")}}),this.registerEntityType("category",{gql:"./queries/categories.gql",queryProcessor:function(e){return e},resultProcessor:function(e,n,r){if(null===e)throw new Error("Invalid graphQl result - null not exepcted");if(e.hasOwnProperty("data"))return Object(s.processESResponseType)(e.data.categories,n,r);throw e.error?new Error(JSON.stringify(e.error)):new Error("Unknown error with graphQl result in resultProcessor for entity type 'category'")}}),this.registerEntityType("taxrule",{gql:"./queries/taxrule.gql",queryProcessor:function(e){return e},resultProcessor:function(e,n,r){if(null===e)throw new Error("Invalid graphQl result - null not exepcted");if(e.hasOwnProperty("data"))return Object(s.processESResponseType)(e.data.taxrule,n,r);throw e.error?new Error(JSON.stringify(e.error)):new Error("Unknown error with graphQl result in resultProcessor for entity type 'taxrule'")}}),this.registerEntityType("cms_page",{gql:"./queries/cmsPage.gql",queryProcessor:function(e){return e},resultProcessor:function(e,n,r){if(null===e)throw new Error("Invalid graphQl result - null not exepcted");if(e.hasOwnProperty("data"))return Object(s.processCmsType)(e.data.cmsPages,n,r);throw e.error?new Error(JSON.stringify(e.error)):new Error("Unknown error with graphQl result in resultProcessor for entity type 'cmsPage'")}}),this.registerEntityType("cms_block",{gql:"./queries/cmsBlock.gql",queryProcessor:function(e){return e},resultProcessor:function(e,n,r){if(null===e)throw new Error("Invalid graphQl result - null not exepcted");if(e.hasOwnProperty("data"))return Object(s.processCmsType)(e.data.cmsBlocks,n,r);throw e.error?new Error(JSON.stringify(e.error)):new Error("Unknown error with graphQl result in resultProcessor for entity type 'cmsBlock'")}}),this.registerEntityType("cms_hierarchy",{gql:"./queries/cmsHierarchy.gql",queryProcessor:function(e){return e},resultProcessor:function(e,n,r){if(null===e)throw new Error("Invalid graphQl result - null not exepcted");if(e.hasOwnProperty("data"))return Object(s.processCmsType)(e.data.cmsHierarchies,n,r);throw e.error?new Error(JSON.stringify(e.error)):new Error("Unknown error with graphQl result in resultProcessor for entity type 'cmsHierarchy'")}})},e}()},963:function(e,n,r){"use strict";r.r(n),r.d(n,"SearchAdapter",(function(){return v}));var t=r(1139),i=r(20),a=r(195),o=r.n(a),s=r(3),u=r(208),c=r.n(u),l=r(8),d=r(0),f=r(21),m=function(e,n,r,t){return new(r||(r=Promise))((function(i,a){function o(e){try{u(t.next(e))}catch(e){a(e)}}function s(e){try{u(t.throw(e))}catch(e){a(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}u((t=t.apply(e,n||[])).next())}))},p=function(e,n){var r,t,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,t&&(i=2&a[0]?t.return:a[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,a[1])).done)return i;switch(t=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,t=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e],t=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},v=function(){function e(){this.entities=[],this.initBaseTypes()}return e.prototype.search=function(e){return m(this,void 0,void 0,(function(){var n,t,a,u,m,v;return p(this,(function(p){switch(p.label){case 0:if(!this.entities[e.type])throw new Error("No entity type registered for "+e.type);return n={},e.searchQuery instanceof i.SearchQuery?[4,r.e(0).then(r.t.bind(null,1406,7))]:[3,3];case 1:return t=p.sent(),[4,i.elasticsearch.buildQueryBodyFromSearchQuery({config:d,queryChain:t.default(),searchQuery:e.searchQuery})];case 2:return n=p.sent(),""!==e.searchQuery.getSearchText()&&(n.min_score=d.elasticsearch.min_score),[3,4];case 3:n=e.searchQuery,p.label=4;case 4:return e.hasOwnProperty("groupId")&&null!==e.groupId&&(n.groupId=e.groupId),e.hasOwnProperty("groupToken")&&null!==e.groupToken&&(n.groupToken=e.groupToken),null!==e.store?[3,5]:(u=Object(l.b)(),[3,7]);case 5:return[4,Object(l.f)(e.store)];case 6:u=p.sent(),p.label=7;case 7:if(a=u,e.index=a.elasticsearch.index,m=Object(s.i)(Object(f.a)(a.elasticsearch,"host")),this.entities[e.type].url&&(m=Object(f.a)(this.entities[e.type],"url")),v={size:e.size,from:e.from,sort:e.sort},e._sourceExclude&&(v._source_exclude=e._sourceExclude.join(",")),e._sourceInclude&&(v._source_include=e._sourceInclude.join(",")),e.q&&(v.q=e.q),!e.index||!e.type)throw new Error("Query.index and Query.type are required arguments for executing ElasticSearch query");return"GET"===d.elasticsearch.queryMethod&&(v.request=JSON.stringify(n)),m=(m=m+"/"+encodeURIComponent(e.index)+"/"+encodeURIComponent(e.type)+"/_search")+"?"+c.a.stringify(v),[2,o()(m,{method:d.elasticsearch.queryMethod,mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"},body:"POST"===d.elasticsearch.queryMethod?JSON.stringify(n):null}).then((function(e){return e.json()})).catch((function(e){throw new Error("FetchError in request to ES: "+e.toString())}))]}}))}))},e.prototype.handleResult=function(e,n,r,i){if(void 0===r&&(r=0),void 0===i&&(i=50),null===e)throw new Error("Invalid ES result - null not exepcted");if(e.hasOwnProperty("hits"))return{items:Object(t.a)(e.hits.hits,(function(e){return Object.assign(e._source,{_score:e._score,slug:e._source.slug?e._source.slug:e._source.hasOwnProperty("url_key")&&d.products.useMagentoUrlKeys?e._source.url_key:e._source.hasOwnProperty("name")?Object(s.m)(e._source.name)+"-"+e._source.id:""})})),total:e.hits.total,start:r,perPage:i,aggregations:e.aggregations,attributeMetadata:e.attribute_metadata,suggestions:e.suggest};var a=(e&&e.code)>=400?e:null;throw e.error||a?new Error(JSON.stringify(e.error||e)):new Error("Unknown error with elasticsearch result in resultProcessor for entity type '"+n+"'")},e.prototype.registerEntityType=function(e,n){var r=n.url,t=void 0===r?"":r,i=n.url_ssr,a=void 0===i?"":i,o=n.queryProcessor,s=n.resultProcessor;return this.entities[e]={queryProcessor:o,resultProcessor:s},""!==t&&(this.entities[e].url=t),""!==a&&(this.entities[e].url_ssr=a),this},e.prototype.initBaseTypes=function(){var e=this;this.registerEntityType("product",{queryProcessor:function(e){return e},resultProcessor:function(n,r,t){return e.handleResult(n,"product",r,t)}}),this.registerEntityType("attribute",{queryProcessor:function(e){return e},resultProcessor:function(n,r,t){return e.handleResult(n,"attribute",r,t)}}),this.registerEntityType("category",{queryProcessor:function(e){return e},resultProcessor:function(n,r,t){return e.handleResult(n,"category",r,t)}}),this.registerEntityType("taxrule",{queryProcessor:function(e){return e},resultProcessor:function(n,r,t){return e.handleResult(n,"taxrule",r,t)}}),this.registerEntityType("review",{queryProcessor:function(e){return e},resultProcessor:function(n,r,t){return e.handleResult(n,"review",r,t)}}),this.registerEntityType("cms_page",{queryProcessor:function(e){return e},resultProcessor:function(n,r,t){return e.handleResult(n,"cms_page",r,t)}}),this.registerEntityType("cms_block",{queryProcessor:function(e){return e},resultProcessor:function(n,r,t){return e.handleResult(n,"cms_block",r,t)}}),this.registerEntityType("cms_hierarchy",{queryProcessor:function(e){return e},resultProcessor:function(n,r,t){return e.handleResult(n,"cms_hierarchy",r,t)}})},e}()},964:function(e,n,r){"use strict";r.r(n),r.d(n,"SearchAdapter",(function(){return h}));var t=r(1139),i=r(195),a=r.n(i),o=r(3),s=r(208),u=r.n(s),c=r(8),l=r(20),d=r(0),f=r(21),m=function(e,n,r,t){return new(r||(r=Promise))((function(i,a){function o(e){try{u(t.next(e))}catch(e){a(e)}}function s(e){try{u(t.throw(e))}catch(e){a(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}u((t=t.apply(e,n||[])).next())}))},p=function(e,n){var r,t,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,t&&(i=2&a[0]?t.return:a[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,a[1])).done)return i;switch(t=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,t=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e],t=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},v=function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var t,i,a=r.call(e),o=[];try{for(;(void 0===n||n-- >0)&&!(t=a.next()).done;)o.push(t.value)}catch(e){i={error:e}}finally{try{t&&!t.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o},h=function(){function e(){this.entities=[],this.initBaseTypes()}return e.prototype.decompactItem=function(e,n){for(var r in n){var t=n[r];void 0!==e[t]&&(e[r]=e[t],delete e[t])}return e},e.prototype.search=function(e){return m(this,void 0,void 0,(function(){var n,r,t,i,s,m,h,y;return p(this,(function(p){switch(p.label){case 0:if(n=e.searchQuery,!this.entities[e.type])throw new Error("No entity type registered for "+e.type);if(!(e.searchQuery instanceof l.SearchQuery))throw new Error('The only supported type of the "Request.searchQuery" is "SearchQuery"');return e.hasOwnProperty("groupId")&&null!==e.groupId&&(n.groupId=e.groupId),e.hasOwnProperty("groupToken")&&null!==e.groupToken&&(n.groupToken=e.groupToken),e.sort&&(r=v(e.sort.split(":"),2),t=r[0],i=r[1],n.applySort({field:t,options:i}),delete e.sort),null!==e.store?[3,1]:(m=Object(c.b)(),[3,3]);case 1:return[4,Object(c.f)(e.store)];case 2:m=p.sent(),p.label=3;case 3:if(s=m,e.index=s.elasticsearch.index,h=Object(o.i)(Object(f.a)(s.elasticsearch,"host")),this.entities[e.type].url&&(h=Object(f.a)(this.entities[e.type],"url")),y={size:e.size,from:e.from,sort:e.sort,request_format:"search-query",response_format:"compact"},e._sourceExclude&&(y._source_exclude=e._sourceExclude.join(",")),e._sourceInclude&&(y._source_include=e._sourceInclude.join(",")),e.q&&(y.q=e.q),!e.index||!e.type)throw new Error("Query.index and Query.type are required arguments for executing ElasticSearch query");return"GET"===d.elasticsearch.queryMethod&&(y.request=JSON.stringify(n)),h=(h=h+"/"+encodeURIComponent(e.index)+"/"+encodeURIComponent(e.type)+"/_search")+"?"+u.a.stringify(y),[2,a()(h,{method:d.elasticsearch.queryMethod,mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"},body:"POST"===d.elasticsearch.queryMethod?JSON.stringify(n):null}).then((function(e){return e.json()})).catch((function(e){throw new Error("FetchError in request to API: "+e.toString())}))]}}))}))},e.prototype.handleResult=function(e,n,r,i){var a=this;if(void 0===r&&(r=0),void 0===i&&(i=50),null===e)throw new Error("Invalid API result - null not exepcted");if(e.hasOwnProperty("hits"))return{items:Object(t.a)(e.hits,(function(e){return"product"===n&&(e=a.decompactItem(e,d.products.fieldsToCompact)).configurable_children&&(e.configurable_children=e.configurable_children.map((function(e){return a.decompactItem(e,d.products.fieldsToCompact)}))),Object.assign(e,{slug:e.slug?e.slug:e.hasOwnProperty("url_key")&&d.products.useMagentoUrlKeys?e.url_key:e.hasOwnProperty("name")?Object(o.m)(e.name)+"-"+e.id:""})})),total:e.total,start:r,perPage:i,aggregations:e.aggregations,attributeMetadata:e.attribute_metadata,suggestions:e.suggest};throw e.error?new Error(JSON.stringify(e.error)):new Error("Unknown error with API catalog result in resultProcessor for entity type '"+n+"'")},e.prototype.registerEntityType=function(e,n){var r=n.url,t=void 0===r?"":r,i=n.url_ssr,a=void 0===i?"":i,o=n.queryProcessor,s=n.resultProcessor;return this.entities[e]={queryProcessor:o,resultProcessor:s},""!==t&&(this.entities[e].url=t),""!==a&&(this.entities[e].url_ssr=a),this},e.prototype.initBaseTypes=function(){var e=this;["product","attribute","category","taxrule","review","cms_page","cms_block","cms_hierarchy"].forEach((function(n){e.registerEntityType(n,{queryProcessor:function(e){return e},resultProcessor:function(r,t,i){return e.handleResult(r,n,t,i)}})}))},e}()}}]);
//# sourceMappingURL=vsf-search-adapter.83ee07831973d7f2c6ae.js.map